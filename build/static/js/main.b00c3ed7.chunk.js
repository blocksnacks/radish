(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{333:function(e,t,n){},351:function(e,t,n){e.exports=n(720)},356:function(e,t,n){},366:function(e,t){},368:function(e,t){},401:function(e,t){},402:function(e,t){},660:function(e,t){},712:function(e,t,n){},717:function(e,t,n){},718:function(e,t,n){},719:function(e,t,n){},720:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(21),l=n.n(c),i=n(48),u=(n(356),n(9)),o=n.n(u),s=n(24),m=n(15),f=n(30),p=n(75),d=n(215),h=new d.UserSession({appConfig:new d.AppConfig(["store_write","publish_data"])});Object(f.configure)({apiServer:Object({NODE_ENV:"production",PUBLIC_URL:""}).DOMAIN||"http://localhost:1260",userSession:h});var b=Object(a.createContext)(),E=n(758),v=(n(712),function(e){var t=e.nullUsername,n=Object(a.useContext)(b),c=n.userSession;return n.loggedIn?r.a.createElement(p.a,{to:"/"}):r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("div",{className:"sign-in"},r.a.createElement("h5",null,"Elegant, secure file sharing \n on the blockchain"),r.a.createElement(E.a,{fullWidth:!0,onClick:function(){return c.redirectToSignIn()},variant:"contained",color:"primary"},"Log in"),t&&r.a.createElement("p",null,"Your username is not yet registered. Please come back again once your registration process is complete."))))}),O=n(780),j=n(761),g=n(765),S=n(762),y=n(763),w=n(777),x=function(e){var t=e.setEmailNotEntered,n=Object(a.useState)(""),c=Object(m.a)(n,2),l=c[0],i=c[1],u=Object(a.useState)(!0),p=Object(m.a)(u,2),d=p[0],h=p[1],b=Object(a.useState)(!1),v=Object(m.a)(b,2),x=v[0],k=v[1],N=Object(a.useState)(!1),C=Object(m.a)(N,2),U=C[0],I=C[1];return Object(a.useEffect)(function(){x&&function(){var e=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.Central.save("UserSettings",{email:l});case 3:h(!1),t(!1),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),I(!0);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}()()},[x,l,t]),r.a.createElement(O.a,{open:d},r.a.createElement(j.a,null,"Please Enter Your Email"),r.a.createElement(S.a,null,r.a.createElement(y.a,null,U?"Something went wrong. Please reload the page.":"In order to share files with other users, you must enter your email address."),r.a.createElement(w.a,{autoFocus:!0,margin:"dense",label:"Email Address",type:"email",fullWidth:!0,onChange:function(e){return i(e.target.value)},value:l})),r.a.createElement(g.a,null,r.a.createElement(E.a,{onClick:function(){return k(!0)},color:"primary",disabled:x||!l},"Sign Up")))},k=n(157),N=n(764),C=n(776),U=n(781),I=function(e){var t=e.selectUser,n=e.deselectUser,c=e.selectedUsers,l=Object(a.useState)(""),i=Object(m.a)(l,2),u=i[0],o=i[1],s=Object(a.useState)([]),p=Object(m.a)(s,2),d=p[0],h=p[1];return Object(a.useEffect)(function(){u.length>2?f.User.fetchList({username:{$regex:u},limit:15,fields:"username"}).then(function(e){h(e.map(function(e){return e.attrs.username}))}):h([])},[u]),r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{fullWidth:!0,value:u,onChange:function(e){return o(e.target.value)}}),c.length?c.map(function(e){return r.a.createElement(U.a,{key:e,value:e,onClick:function(){return n(e)}},"Selected: ",e)}):null,d.length?d.filter(function(e){return!c.includes(e)}).map(function(e){return r.a.createElement(U.a,{key:e,value:e,onClick:function(){return t(e)}},e)}):null)},P=function(){var e=Object(s.a)(o.a.mark(function e(t,n,a){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={recipients:t,creator:a.loadUserData().username,groupName:n},e.prev=1,e.next=4,fetch("/email/invite-users/",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});case 4:return e.next=6,e.sent.json();case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return","ErrorPostingEmails");case 13:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t,n,a){return e.apply(this,arguments)}}(),A=Object(p.g)(function(e){var t=e.history,n=Object(a.useContext)(b),c=n.userSession,l=n.setUserGroup,i=Object(a.useState)(""),u=Object(m.a)(i,2),p=u[0],d=u[1],h=Object(a.useState)(null),v=Object(m.a)(h,2),O=v[0],j=v[1],g=Object(a.useState)([]),S=Object(m.a)(g,2),y=S[0],w=S[1],x=Object(a.useState)(""),A=Object(m.a)(x,2),_=A[0],F=A[1],D=Object(a.useState)([]),G=Object(m.a)(D,2)[1],B=Object(a.useState)([]),L=Object(m.a)(B,2),T=L[0],z=L[1];Object(a.useEffect)(function(){f.UserGroup.myGroups().then(z)},[]);var W=function(){var e=Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new f.UserGroup({name:p}).create();case 4:t=e.sent,j(t),F(t),z(function(e){return e.concat(t)});case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(y.map(function(){var e=Object(s.a)(o.a.mark(function e(t){var n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.makeGroupMembership(t);case 2:return n=e.sent,a=n._id,e.abrupt("return",{blockstackId:t,inviteId:a});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 3:t=e.sent,G(function(e){return[].concat(Object(k.a)(e),[t])}),P(t,p,c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("fail to send invites: %o",e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("div",{className:"form-container"},r.a.createElement("h2",null,"Choose a group to share with"),r.a.createElement(C.a,{onChange:function(e){return F(e.target.value)},value:_},T.map(function(e){return r.a.createElement(U.a,{value:e,key:e._id},e.attrs.name)})),r.a.createElement("h2",null,"...or create a new group"),r.a.createElement("div",null,r.a.createElement("h3",null,"Enter Usergroup Name"),r.a.createElement("div",{className:"input-container"},r.a.createElement(N.a,{autoFocus:!0,fullWidth:!0,value:p,onChange:function(e){var t=e.target;return d(t.value)}})),r.a.createElement(E.a,{variant:"contained",color:"primary",onClick:W,disabled:!O&&!p.length||!!O},"Create User Group")),r.a.createElement("div",null,r.a.createElement("h3",null,"Select Recipients"),r.a.createElement("div",{className:"input-container"},r.a.createElement(I,{selectUser:function(e){return w(y.concat(e))},deselectUser:function(e){var t=y.indexOf(e);w(y.slice(0,t).concat(y.slice(t+1)))},selectedUsers:y})),r.a.createElement(E.a,{variant:"contained",color:"primary",onClick:R,disabled:!O||!y.length},"Invite Users")),r.a.createElement(E.a,{variant:"contained",color:"secondary",onClick:function(){l(_),t.push("/upload")},disabled:!_},"Share With This Group")))}),_=n(760),F=n(778),D=n(766),G=Object(p.g)(function(e){var t=e.location.pathname,n=Object(a.useContext)(b).userSession,c=Object(a.useState)("/upload"===t?"/":t),l=Object(m.a)(c,2),u=l[0],o=l[1];return r.a.createElement(_.a,null,r.a.createElement(F.a,{value:u,onChange:function(e,t){return o(t)},indicatorColor:"primary",textColor:"primary",centered:!0},r.a.createElement(D.a,{label:"Create Group",to:"/",value:"/",component:i.b}),r.a.createElement(D.a,{label:"Shared With Me",to:"/shared",value:"/shared",component:i.b}),r.a.createElement(D.a,{label:"Logout",variant:"contained",color:"primary",onClick:function(){return n.signUserOut(Object({NODE_ENV:"production",PUBLIC_URL:""}).DOMAIN||"http://localhost:1260")}})))}),B=function(e){return function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(G,null),r.a.createElement(e,t))}},L=function(e){return function(t){return Object(a.useContext)(b).loggedIn?r.a.createElement(e,t):r.a.createElement(p.a,{to:"/login"})}},T=L(B(function(e){var t=e.emailNotEntered,n=e.setEmailNotEntered;return r.a.createElement("div",{className:"main-container"},t&&r.a.createElement(x,{setEmailNotEntered:n}),r.a.createElement(A,null))})),z=n(767),W=(n(717),function(){return r.a.createElement("div",{className:"circular-progress"},r.a.createElement(z.a,{size:100}))}),R=n(768),M=(n(718),function e(){return new Promise(function(e){return e()}).then(function(){return{activate:e}})}),J=L(B(function(e){var t=e.match.params,n=Object(a.useState)(!1),c=Object(m.a)(n,2),l=c[0],i=c[1];return Object(a.useEffect)(function(){Object(s.a)(o.a.mark(function e(){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t.invitation_id);case 2:return n=e.sent,e.next=5,n.activate();case 5:return e.next=7,new Promise(function(e){return setTimeout(e,3e3)});case 7:i(!0);case 8:case"end":return e.stop()}},e)}))()},[t.invitation_id]),l?r.a.createElement(p.a,{to:"/shared"}):r.a.createElement(R.a,null,r.a.createElement("div",{className:"content-container"},r.a.createElement("h3",{className:"invite-header"},"Accepting the invitation to share ",t.invitation_id,"... Please wait!"),r.a.createElement(W,null)))})),Y=n(769),V=n(770),K=n(771),$=n(772),q=n(773),H=n(339),Q=n.n(H),X=(n(333),n(154)),Z=n(158),ee=n(155),te=n(159),ne=["_id","radiksType","createdAt","updatedAt","signingKeyId","radiksSignature"],ae=function(e){function t(){return Object(X.a)(this,t),Object(Z.a)(this,Object(ee.a)(t).apply(this,arguments))}return Object(te.a)(t,e),t}(function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(X.a)(this,t),e=Object(Z.a)(this,Object(ee.a)(t).call(this,n));var a=new Set(ne.concat(Object.keys(e.schema)));return Object.keys(n).forEach(function(t){if(!a.has(t))throw new Error("".concat(t," is not in ").concat("function"===typeof e.modelName?e.modelName():""," schema"))}),e}return Object(te.a)(t,e),t}(f.Model));ae.className="SharedDocument",ae.schema={name:String,extension:String,mimeType:String,userGroupId:{type:String,decrypted:!0},uploadedBy:String,size:Number,content:String};var re=L(B(function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(!1),i=Object(m.a)(l,2),u=i[0],f=i[1],p=Object(a.useState)(!1),d=Object(m.a)(p,2),h=d[0],b=d[1],v=Object(a.useState)(!1),O=Object(m.a)(v,2),j=O[0],g=O[1],S=Object(a.useState)(null),y=Object(m.a)(S,2),w=y[0],x=y[1];return Object(a.useEffect)(function(){Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b(!0),e.next=4,ae.fetchList();case 4:e.t0=function(e){return"string"===typeof e.attrs.name},e.t1=function(e){var t=e.attrs;return{id:t._id,name:t.name,createdDate:t.createdAt,size:t.size,uploadedBy:t.uploadedBy,content:t.content,mimeType:t.mimeType}},t=e.sent.filter(e.t0).map(e.t1),b(!1),c(t),e.next=15;break;case 11:e.prev=11,e.t2=e.catch(0),console.error(e.t2),f(!0);case 15:case"end":return e.stop()}},e,null,[[0,11]])}))()},[]),Object(a.useEffect)(function(){Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:j&&w&&((t=document.createElement("a")).href=w.content,t.download=w.name,t.click(),x(null),g(!1));case 1:case"end":return e.stop()}},e)}))()},[j,w]),r.a.createElement("div",null,r.a.createElement("h2",{className:"table-title"},"Files Shared with me"),u?r.a.createElement("div",null,"Error retrieving shared files"):n.length?r.a.createElement("div",{className:"table-container"},r.a.createElement(Y.a,null,r.a.createElement(V.a,null,r.a.createElement(K.a,null,r.a.createElement($.a,null,"File ID"),r.a.createElement($.a,null,"File Name"),r.a.createElement($.a,null,"Created At"),r.a.createElement($.a,null,"Size"),r.a.createElement($.a,null,"Uploaded By"),r.a.createElement($.a,null,"Download"))),r.a.createElement(q.a,null,n.map(function(e){return r.a.createElement(K.a,{key:e.id},r.a.createElement($.a,null,e.id),r.a.createElement($.a,null,e.name),r.a.createElement($.a,null,e.createdDate),r.a.createElement($.a,null,Q()(e.size)),r.a.createElement($.a,null,e.uploadedBy),r.a.createElement($.a,null,r.a.createElement(E.a,{disabled:j,onClick:function(){x(e),g(!0)}},"DL")))})))):h?r.a.createElement(W,null):r.a.createElement("div",null,"You don't have any documents"))})),ce=n(774),le=n(775),ie=n(783),ue=(n(719),Object(ce.a)(function(e){return{fab:{margin:e.spacing(1)},button:{margin:e.spacing(1)}}})),oe=L(B(Object(p.g)(function(e){var t=e.history,n=Object(a.useContext)(b),c=n.userGroup,l=n.userSession,i=ue(),u=Object(a.useRef)(null),f=Object(a.useState)(null),d=Object(m.a)(f,2),h=d[0],v=d[1],O=Object(a.useState)(!1),j=Object(m.a)(O,2),g=j[0],S=j[1];Object(a.useEffect)(function(){!function(){var e=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=5;break}return S(!1),e.next=4,Promise.all(h.map(function(e){return new Promise(function(n){var a=new FileReader;a.onload=function(){var a=Object(s.a)(o.a.mark(function a(r){var i,u;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r.target.result,u=new ae({name:e.name,extension:e.name.split(".").pop(),mimeType:e.type,userGroupId:c._id,uploadedBy:l.loadUserData().username,size:e.size,content:i}),a.next=4,u.save();case 4:t.push("/shared"),n();case 6:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),a.readAsDataURL(e)})}));case 4:v(null);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[h,c,l,g,t]);return c?r.a.createElement("div",{className:"share-wrapper"},r.a.createElement("h2",{className:"share-header"},"Share with ",c.attrs.name),r.a.createElement("div",{className:"share-file-container"},r.a.createElement("section",{className:"share-file-main"},r.a.createElement("div",{className:"share-file-upload-file"},r.a.createElement("input",{id:"hidden-file-input",multiple:!0,type:"file",ref:u,onChange:function(){return v(Array.from(u.current.files))}}),r.a.createElement("label",{htmlFor:"hidden-file-input"},r.a.createElement(le.a,{"aria-label":"add",component:"span",color:"primary",className:i.fab},r.a.createElement(ie.a,null))),r.a.createElement("p",{className:"no-margin"},"Click to add"),r.a.createElement("p",{className:"no-margin center"},"files to share"),h&&h.length&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"file-list"},r.a.createElement("h4",null,"Files to share:"),r.a.createElement("ul",null,h.map(function(e){return r.a.createElement("li",{className:"no-margin",key:e.name},e.name)}))),r.a.createElement(E.a,{variant:"contained",color:"primary",className:i.button,onClick:function(){v(Array.from(u.current.files)),h&&h.length&&S(!0)},fullWidth:!0},"Send Files"))),r.a.createElement("div",{className:"share-file-description"},r.a.createElement("h1",{className:"no-margin"}," Simple Private BlockSnack File Sharing"),r.a.createElement("p",null,"Add the files you'd like to share with your group"))))):r.a.createElement(p.a,{to:"/"})}))),se=function(){var e=Object(a.useContext)(b).userSession,t=Object(a.useState)(!0),n=Object(m.a)(t,2),c=n[0],l=n[1],i=Object(a.useState)(!1),u=Object(m.a)(i,2),d=u[0],h=u[1];return Object(a.useEffect)(function(){!function(){var t=Object(s.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isUserSignedIn()||!e.isSignInPending()){t.next=12;break}return t.next=3,e.handlePendingSignIn();case 3:return t.prev=3,t.next=6,f.User.createWithCurrentUser();case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(3),console.error(t.t0,"redirecting..."),h(!0);case 12:l(!1);case 13:case"end":return t.stop()}},t,null,[[3,8]])}));return function(){return t.apply(this,arguments)}}()()},[e]),d?r.a.createElement(p.a,{to:"/"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.d,null,r.a.createElement(p.b,{exact:!0,path:"/login",component:v}),"}",r.a.createElement(p.b,{exact:!0,path:"/",component:c?W:T}),r.a.createElement(p.b,{exact:!0,path:"/upload",component:oe}),r.a.createElement(p.b,{exact:!0,path:"/shared",component:re}),r.a.createElement(p.b,{path:"/invitation/:invitation_id",component:J})))};l.a.render(r.a.createElement(function(e){var t=e.children,n=Object(a.useState)(null),c=Object(m.a)(n,2),l=c[0],i=c[1],u=Object(a.useState)(h.isUserSignedIn()),p=Object(m.a)(u,2),d=p[0],E=p[1],v=Object(a.useState)(!1),O=Object(m.a)(v,2),j=O[0],g=O[1];return Object(a.useEffect)(function(){Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=7;break}return e.next=3,f.Central.get("UserSettings");case 3:t=e.sent,g(!t||!t.email),e.next=8;break;case 7:E(!1);case 8:case"end":return e.stop()}},e)}))()},[d]),r.a.createElement(b.Provider,{value:{userSession:h,userGroup:l,setUserGroup:i,emailNotEntered:j,loggedIn:d}},t)},null,r.a.createElement(i.a,null,r.a.createElement(se,null))),document.getElementById("root"))}},[[351,1,2]]]);
//# sourceMappingURL=main.b00c3ed7.chunk.js.map